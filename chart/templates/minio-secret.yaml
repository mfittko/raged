{{- if .Values.minio.enabled }}
{{- if not .Values.minio.accessKey }}
{{- fail "minio.accessKey must be set when minio.enabled is true. Please provide a secure access key via --set minio.accessKey=<value>" }}
{{- end }}
{{- if not .Values.minio.secretKey }}
{{- fail "minio.secretKey must be set when minio.enabled is true. Please provide a secure secret key via --set minio.secretKey=<value>" }}
{{- end }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-minio-secret
  labels:
    {{- include "rag.labels" . | nindent 4 }}
type: Opaque
stringData:
  MINIO_ROOT_USER: "{{ .Values.minio.accessKey }}"
  MINIO_ROOT_PASSWORD: "{{ .Values.minio.secretKey }}"
  BLOB_STORE_URL: "http://{{ .Release.Name }}-minio:{{ .Values.minio.service.apiPort }}"
  BLOB_STORE_ACCESS_KEY: "{{ .Values.minio.accessKey }}"
  BLOB_STORE_SECRET_KEY: "{{ .Values.minio.secretKey }}"
  BLOB_STORE_BUCKET: "{{ .Values.minio.bucket }}"
{{- end }}
